<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snake Game</title>
  <style>
    body {
      background: #000;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: monospace;
      color: #0f0;
      user-select: none;
    }
    #canvas {
      background: #111;
      border: 4px solid #0f0;
      margin-top: 20px;
      touch-action: none;
    }
    #score, #startBtn {
      margin: 20px;
      font-size: 20px;
    }
    #startBtn {
      padding: 10px 25px;
      background: #0f0;
      color: #000;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    #startBtn:active {
      background: #6f6;
    }
  </style>
</head>
<body>
  <h2>Classic Snake</h2>
  <canvas id="canvas" width="320" height="320"></canvas>
  <div id="score">Score: 0</div>
  <button id="startBtn">Start Game</button>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const grid = 16;
    const tileCount = canvas.width / grid;
    const scoreDisplay = document.getElementById('score');
    const startBtn = document.getElementById('startBtn');

    let snake, direction, food, score, gameOver, frameCount;

    function placeFood() {
      food = {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount)
      };
      if (snake.some(s => s.x === food.x && s.y === food.y)) placeFood();
    }

    function resetGame() {
      snake = [{x: 8, y: 8}];
      direction = {x: 1, y: 0}; // start moving right
      score = 0;
      gameOver = false;
      frameCount = 0;
      placeFood();
      scoreDisplay.textContent = "Score: 0";
      gameLoop();
    }

    function gameLoop() {
      if (gameOver) {
        ctx.fillStyle = "#0f0";
        ctx.font = "18px monospace";
        ctx.fillText("GAME OVER", 90, 150);
        ctx.fillText("Tap 'Start' to play again", 35, 180);
        return;
      }

      requestAnimationFrame(gameLoop);
      if (++frameCount < 8) return;
      frameCount = 0;

      const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};

      if (
        head.x < 0 || head.x >= tileCount ||
        head.y < 0 || head.y >= tileCount ||
        snake.some(s => s.x === head.x && s.y === head.y)
      ) {
        gameOver = true;
        return;
      }

      snake.unshift(head);
      if (head.x === food.x && head.y === food.y) {
        score++;
        scoreDisplay.textContent = "Score: " + score;
        placeFood();
      } else {
        snake.pop();
      }

      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "#0f0";
      ctx.fillRect(food.x * grid, food.y * grid, grid - 2, grid - 2);
      snake.forEach(s => {
        ctx.fillRect(s.x * grid, s.y * grid, grid - 2, grid - 2);
      });
    }

    // Direction controls
    window.addEventListener("keydown", e => {
      switch (e.key) {
        case "ArrowUp": if (direction.y !== 1) direction = {x: 0, y: -1}; break;
        case "ArrowDown": if (direction.y !== -1) direction = {x: 0, y: 1}; break;
        case "ArrowLeft": if (direction.x !== 1) direction = {x: -1, y: 0}; break;
        case "ArrowRight": if (direction.x !== -1) direction = {x: 1, y: 0}; break;
      }
    });

    // Swipe support
    let startX = 0, startY = 0;
    canvas.addEventListener("touchstart", e => {
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    });
    canvas.addEventListener("touchend", e => {
      const dx = e.changedTouches[0].clientX - startX;
      const dy = e.changedTouches[0].clientY - startY;
      if (Math.abs(dx) > Math.abs(dy)) {
        if (dx > 20 && direction.x !== -1) direction = {x: 1, y: 0};
        else if (dx < -20 && direction.x !== 1) direction = {x: -1, y: 0};
      } else {
        if (dy > 20 && direction.y !== -1) direction = {x: 0, y: 1};
        else if (dy < -20 && direction.y !== 1) direction = {x: 0, y: -1};
      }
    });

    startBtn.addEventListener("click", resetGame);
  </script>
</body>
</html>
